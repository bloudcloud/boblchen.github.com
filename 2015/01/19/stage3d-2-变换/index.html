<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>stage3d_2_变换 | Hello World</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="我们用几何方式描述3D场景中的物体。在游戏开发中我们会对物体进行变换，例如：平移、缩放、旋转。之前我们谈到向量、矩阵。以及特殊的向量矩阵和矩阵之前的数学运算。在游戏开发中，我们可以通过这种数学运算来描述物体的变换。
基本变换
当我们进行3D编程时，我们使用4x4矩阵来描述变换操作。为何会用到4x4矩阵?因为在3D中，一个点具有三个维度，例如A(x, y, z)。但是为何不用3x3矩阵而是用4x4矩">
<meta property="og:type" content="article">
<meta property="og:title" content="stage3d_2_变换">
<meta property="og:url" content="http://yoursite.com/2015/01/19/stage3d-2-变换/">
<meta property="og:site_name" content="Hello World">
<meta property="og:description" content="我们用几何方式描述3D场景中的物体。在游戏开发中我们会对物体进行变换，例如：平移、缩放、旋转。之前我们谈到向量、矩阵。以及特殊的向量矩阵和矩阵之前的数学运算。在游戏开发中，我们可以通过这种数学运算来描述物体的变换。
基本变换
当我们进行3D编程时，我们使用4x4矩阵来描述变换操作。为何会用到4x4矩阵?因为在3D中，一个点具有三个维度，例如A(x, y, z)。但是为何不用3x3矩阵而是用4x4矩">
<meta property="og:image" content="/images/stage3d_2_变换/F98F3A36-CCED-4971-9712-F20B8C2DB1F8.png">
<meta property="og:image" content="/images/stage3d_2_变换/6982A87D-E009-4F37-9CCA-C2B4A4D59A05.png">
<meta property="og:image" content="/images/stage3d_2_变换/F5214C3E-5791-473C-BC8C-442EB7AD66A3.png">
<meta property="og:image" content="/images/stage3d_2_变换/4240049F-7C97-4DE1-98D3-1DE9DC4B38C9.png">
<meta property="og:image" content="/images/stage3d_2_变换/1D3F0873-5638-46C5-9ECB-A96A0C88A83A.png">
<meta property="og:image" content="/images/stage3d_2_变换/F50AA021-1F40-42BA-8DCF-739752F4E9A0.png">
<meta property="og:image" content="/images/stage3d_2_变换/A2C80596-1354-4A68-A9B9-B642B40E3FB8.png">
<meta property="og:image" content="/images/stage3d_2_变换/67D79741-72A6-4BDC-88D7-E40E84B08ED5.png">
<meta property="og:image" content="/images/stage3d_2_变换/4DD2AE6A-C957-4777-92DB-88C599B68BC7.png">
<meta property="og:image" content="/images/stage3d_2_变换/549FBC57-9C71-4977-86D4-BABA4D530B2C.png">
<meta property="og:image" content="/images/stage3d_2_变换/8BA13BD6-0613-460F-A716-7786DC55E05F.png">
<meta property="og:image" content="/images/stage3d_2_变换/1A224D67-EE3E-4B74-904C-716E700E5E84.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="stage3d_2_变换">
<meta name="twitter:description" content="我们用几何方式描述3D场景中的物体。在游戏开发中我们会对物体进行变换，例如：平移、缩放、旋转。之前我们谈到向量、矩阵。以及特殊的向量矩阵和矩阵之前的数学运算。在游戏开发中，我们可以通过这种数学运算来描述物体的变换。
基本变换
当我们进行3D编程时，我们使用4x4矩阵来描述变换操作。为何会用到4x4矩阵?因为在3D中，一个点具有三个维度，例如A(x, y, z)。但是为何不用3x3矩阵而是用4x4矩">

  
    <link rel="alternative" href="/atom.xml" title="Hello World" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css" type="text/css">

  

</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hello World</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><input type="submit" value="&#xF002;" class="search-form-submit"><input type="hidden" name="q" value="site:http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-stage3d-2-变换" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/01/19/stage3d-2-变换/" class="article-date">
  <time datetime="2015-01-19T12:19:14.000Z" itemprop="datePublished">Jan 19 2015</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/3D/">3D</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      stage3d_2_变换
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>我们用几何方式描述3D场景中的物体。在游戏开发中我们会对物体进行变换，例如：平移、缩放、旋转。之前我们谈到向量、矩阵。以及特殊的向量矩阵和矩阵之前的数学运算。在游戏开发中，我们可以通过这种数学运算来描述物体的变换。</p>
<h2 id="基本变换">基本变换</h2>
<p>当我们进行3D编程时，我们使用4x4矩阵来描述变换操作。为何会用到4x4矩阵?因为在3D中，一个点具有三个维度，例如A(x, y, z)。但是为何不用3x3矩阵而是用4x4矩阵。之前向量就谈到，向量只有方向和大小。例如向量A(x, y, z)。这里的向量A和之前的点都是使用同一种方式来描述。所以我们就无法区别(x, y, z)到底是向量还是点。因为向量只与大小方向有关，我们在变换时可能会错误的改变向量的方向以及大小，那么这个时候我们就要用一个标识来区分向量和点。因此我们就会增加一项变为(x, y, z, w)。又根据矩阵的定义，因此我们需要使用4x4矩阵。在其它情况下面，例如透视投影、反射等情况，3x3矩阵同样无法满足我们的需求。因此扩充为4x4。</p>
<ul>
<li>(x, y, z, 0)用于向量</li>
<li>(x, y, z, 1)用于点<h3 id="缩放">缩放</h3>
缩放是指改变一个物体的大小。假设一个三角形，那么三角形势必就会有三个顶点，如果我们对着三个顶点进行一次同样的缩放，那么这个三角形就会被同等缩放。因此我们这里讨论对点进行缩放。回想一下之前矩阵的运算方式。其中最特殊的就是单位矩阵。即一个点(x, y, z, w) 乘以 4x4 单位矩阵，结果仍然是 (x, y, z, w)。4x4单位矩阵是对角线均为1。然后根据矩阵运算的定义，我们如果对对角线1进行缩放，那么结果也会被缩放。缩放矩阵为:<br><img src="/images/stage3d_2_变换/F98F3A36-CCED-4971-9712-F20B8C2DB1F8.png" class="[class names]"><br>其中Sx, Sy, Sz为x、y、z轴的缩放倍数。<br>假设我们通过一个最小点(−4,−4,0)和一个最大点(4,4,0)定义一个正方形,我们希望将正方形沿x轴缩小0.5倍,沿y轴放大2.0倍,z轴保持不变。则对应的缩放矩阵为:<br><img src="/images/stage3d_2_变换/6982A87D-E009-4F37-9CCA-C2B4A4D59A05.png" class="[class names]"><br>现在,对正方形进行缩放(变换),将正方形的两个点与该矩阵相乘:<br><img src="/images/stage3d_2_变换/F5214C3E-5791-473C-BC8C-442EB7AD66A3.png" class="[class names]"><br>结果如图所示:<br><img src="/images/stage3d_2_变换/4240049F-7C97-4DE1-98D3-1DE9DC4B38C9.png" class="[class names]"><h3 id="旋转">旋转</h3>
旋转比较复杂，这里就直接给出旋转矩阵:<br><img src="/images/stage3d_2_变换/1D3F0873-5638-46C5-9ECB-A96A0C88A83A.png" class="[class names]"><br>其中轴 n=(x,y,z)，旋转角度为𝜃。其中c=cos𝜃、s=sin𝜃。即一个点或者向量绕着轴(x,y,z)旋转𝜃角度。顺时针为正方向。例如:假设我们通过一个最小点(−1,0,−1)和一个最大点(1,0,1)定义一个正方形。让正方形绕着y轴的顺时针方向旋转−30°(即,逆时针方向旋转30°)。则y轴旋转矩阵为:<br><img src="/images/stage3d_2_变换/F50AA021-1F40-42BA-8DCF-739752F4E9A0.png" class="[class names]"><br>对正方形进行变换如下:<br><img src="/images/stage3d_2_变换/A2C80596-1354-4A68-A9B9-B642B40E3FB8.png" class="[class names]"><br><img src="/images/stage3d_2_变换/67D79741-72A6-4BDC-88D7-E40E84B08ED5.png" class="[class names]"><h3 id="平移">平移</h3>
平移最简单,只需要在原来的基础上加上一个位移向量即可。矩阵如下:<br><img src="/images/stage3d_2_变换/4DD2AE6A-C957-4777-92DB-88C599B68BC7.png" class="[class names]"><br>例如:我们通过一个最小点(−8,2,0)和一个最大点(−2,8,0)定义一个正方形让正方形沿x轴平移12,沿y轴平移−10,z轴保持不变。则对应的平移矩阵如下:<br><img src="/images/stage3d_2_变换/549FBC57-9C71-4977-86D4-BABA4D530B2C.png" class="[class names]"><br>然后对正方形进行平移:<br><img src="/images/stage3d_2_变换/8BA13BD6-0613-460F-A716-7786DC55E05F.png" class="[class names]"><br><img src="/images/stage3d_2_变换/1A224D67-EE3E-4B74-904C-716E700E5E84.png" class="[class names]"><br>如果我们需要向量进行平移，那么我们只需要设置点为(x, y, z, 0)。因为0乘以平移量Bx,By,Bz仍然为0。<h3 id="组合">组合</h3>
我们将旋转、平移、缩放矩阵组合成一个矩阵。那么这个矩阵就可以完成我们需要的平移、缩放、旋转同时变换。</li>
</ul>
<h3 id="模型空间">模型空间</h3>
<p>我们不仅可以使用矩阵来描述模型的变换，而且也可以使用矩阵来代表一个模型本身。例如该模型本身是绕y轴偏转了30°，平移量(1, 2, 3)，缩放为(1, 2, 1)。那么就可以通过这三个量来组件一个矩阵出来，这个矩阵就代表了这个模型，这个矩阵也就是这个模型空间。</p>
<h3 id="视角">视角</h3>
<p>小时候有一篇课文，讲的是一个小朋友照着一个实物画画，其它小朋友画出的都是一样，唯独这个小朋友画出来的不一样。<a href="http://baike.baidu.com/link?url=Bw0MjE2beRSHW_I8MBpyxDTbWnN65ZjQ-iMv1WWGKA8rSuSLLrWcx1ToQGuDCG6mGJPp9eD1ATL8y38_0NVmo_" target="_blank" rel="external">画杨桃课文</a> 之所以出现这种情况，就是因为每个小朋友的位置方向角度都不一样，因此看到的东西也就不一样。我们称这个小朋友为view空间。在3d游戏中，如果把相机看成一个模型，view其实就是相机的模型空间的逆矩阵。为何是逆矩阵？ 因为我们看到的东西都是反向的。</p>
<h3 id="投影空间">投影空间</h3>
<p>每一个人的计算机屏幕都是不一样的，有些是21英寸、有些是23英寸、27英寸等等。我们在3D开发中不可能去适配所有的尺寸。因此我们需要能够用一种方式来适配所有的情况。gpu已经针对这种情况进行了适配，统一将屏幕的宽高设置为[-1, 1]区间。这样无论尺寸大小如果，总是[-1, 1]区间。因此我们需要将最终的模型映射到这个区间上面来。这个过程就称之为投影。这个区间也称之为NDC空间。在投影的时候，我们可以对投影矩阵进行一些改造，例如达到近大远小的效果(透视投影)，或者达到无论多远都是一样大小(正交投影)。</p>
<h4 id="正交投影算法">正交投影算法</h4>
<p>正交投影的算法我就不会进行推导，这里给出别人的推导过程。<a href="http://blog.csdn.net/popy007/article/details/4126809" target="_blank" rel="external">链接地址</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/01/19/stage3d-2-变换/" data-id="tqaa5o7e02hou6uy" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/3D/">3D</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/FLash3D/">FLash3D</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Stage3D/">Stage3D</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2015/01/20/stage3d-3-模型基础概念/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          stage3d_3_初窥3d编程
        
      </div>
    </a>
  
  
    <a href="/2015/01/18/stage3d-矩阵-1/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">矩阵</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/3D/">3D</a><span class="category-list-count">4</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/3D/">3D</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/FLash3D/">FLash3D</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Stage3D/">Stage3D</a><span class="tag-list-count">4</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/3D/" style="font-size: NaNpx;">3D</a><a href="/tags/FLash3D/" style="font-size: NaNpx;">FLash3D</a><a href="/tags/Stage3D/" style="font-size: NaNpx;">Stage3D</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/01/">January 2015</a><span class="archive-list-count">4</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2015/01/20/stage3d-3-模型基础概念/">stage3d_3_初窥3d编程</a>
          </li>
        
          <li>
            <a href="/2015/01/19/stage3d-2-变换/">stage3d_2_变换</a>
          </li>
        
          <li>
            <a href="/2015/01/18/stage3d-矩阵-1/">矩阵</a>
          </li>
        
          <li>
            <a href="/2015/01/18/stage3d-向量-0/">向量</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2015 小朋友<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">

  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>



<script src="/js/script.js" type="text/javascript"></script>


  </div>
</body>
</html>